# SyncCals: Calendar Synchronization Tool

SyncCals is a tool for synchronizing calendars between different services.

## English Instructions
This requires that Chrome be installed on your Windows system.

### 1. Install Python (Windows)

-  Open a command prompt and type the following to check if Python is not installed:

    ```bash
    python
    ```

-  Or, download and install Python from:<br/>
   [https://www.python.org/downloads/windows/](https://www.python.org/downloads/windows/)

### 2. Install Required Modules

-  Open a command prompt and execute the following commands to install the necessary Python modules. These modules are required for SyncCals to function properly. `selenium` is used for web automation, and `pyyaml` is used for reading the configuration file.

    ```bash
    python -m pip install --upgrade pip
    pip install selenium
    pip install pyyaml
    ```

### 3. Configure SyncCals

1.  Rename the `@config.yaml` to `config.yaml` file.
2.  Edit the `config.yaml` file to configure your calendar settings, such as the calendar server and any necessary credentials.

### 4. Create Log Folder

-  Create a log folder to store log files generated by SyncCals. Open a command prompt from SyncCals folder, and execute the following:

    ```bash
    mkdir log
    ```

### 5. Start SyncCals

-  Open a command prompt and execute the following to start SyncCals:

    ```bash
    python main.py
    ```

## 手順 (日本語)

Windows環境でchromeがインストールされていることが前提です。

### 1. Pythonのインストール (Windows)

-  コマンドプロンプトを開き、以下を入力してPythonがインストールされているか確認します。
    Pythonがインストールされていない場合は、表示される指示に従ってインストールします。

    ```bash
    python
    ```

-   または、以下のサイトからWindows用のPythonをダウンロードしてインストールします。<br/>
    https://www.python.org/downloads/windows/

### 2. Pythonモジュールのインストール

-  コマンドプロンプトから以下を実行して必要なモジュールをインストールします。これらのモジュールはSyncCalsが正常に動作するために必要です。`selenium`はウェブ自動化に使用され、`pyyaml`は設定ファイルの読み込みに使用されます。

    ```bash
    python -m pip install --upgrade pip
    pip install selenium
    pip install pyyaml
    ```

### 3. 設定ファイルの変更

1.  サンプルの`@config.yaml`ファイルを`config.yaml`ファイルにコピーします。
2.  `config.yaml`ファイルを編集して、カレンダーの設定（カレンダーのサーバや必要な認証情報など）を編集します。

### 4. ログフォルダの作成

-  SyncCalsが生成するログファイルを保存するためのログフォルダを作成します。コマンドプロンプトから以下を実行します。

    ```bash
    mkdir log
    ```

### 5. SyncCalsを実行します。

-  コマンドプロンプトから以下を実行します。

    ```bash
    python main.py
    ```
-  必要に応じて以下のBATファイル(start.bat等)を作成すると、BATファイルのダブルクリックで実行できるようになります。<br/>

    `start.bat`:
    ```
      python main.py
      pause
    ```
## カレンダーの同期動作について (日本語)
### 1. カレンダー情報の取得
-  confで設定したカレンダをブラウザで巡回し、全ての予定データを取得します。
   全カレンダーのデータを取得したら、中間のマージファイルとしてlog/mid_merge.yamlに保存します。
-  confで`skipget=1`が設定されている場合は、ブラウザを使わず、前述の中間のマージファイルを読み込みます。

### 2. カレンダー情報の同期チェック
-  同期プラグインに応じて、カレンダーの追加/削除が必要な予定を抽出します。
   現在のプラグイン(cb2ar.py)は、サイボウズの予定とAirリザーブの予定を同期するためのチェックをします。
   ※サイボウズのみにしかない予定をAirリザーブに追加、かつAirリザーブのみにしか無い予定で本ツールで自動追加した予定をキャンセル。

### 3. カレンダー更新
-  confで設定したカレンダをブラウザで巡回し、差分の予定を追加/削除します。
    waitadd/waitdel設定により、追加/削除の直前に、本当に追加してよいか確認の入力が求められます。「y」以外を入力すると、追加or削除は行われません。

